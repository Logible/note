# Class的基本语法

## 1.简介

### 1.1 类的由来

JavaScript语言中，生成实例对象的传统方法是通过构造函数

```js
function Point(x, y) {
  this.x = x;
  this.y = y;
}

Point.prototype.toString = function () {
  return '(' + this.x + ', ' + this.y + ')';
};

var p = new Point(1, 2);
```

而ES6提供了更接近传统语言的写法,引入了Class概念,作为对象的模板,通过<code style="color:#ea4335">class</code>关键字,可以定义类

```js
class Point {
    constructor(x, y) {
        this.x = x;
        this.y = y;
    }

    toString(){
        return '(' + this.x + ', ' + this.y + ')';
    }
}


typeof Point // "function"
Point === Point.prototype.constructor // true

let point1 = new Point(1,2);//(1,2)
console.log(point1.toString());
```

- 这种写法与开头构造函数<code style="color:#ea4335">Ponit</code>是一致的
- 类的数据类型就是函数,类本身就指向构造函数
- 使用的时候,也是直接对类使用<code style="color:#ea4335">new</code>命令,跟构造函数的用法完全一致

构造函数的<code style="color:#ea4335">prototype</code>属性,在ES6的"类"上继续存在

```js
class Point {
  constructor() {
    // ...
  }

  toString() {
    // ...
  }

  toValue() {
    // ...
  }
}

// 等同于

Point.prototype = {
  constructor() {},
  toString() {},
  toValue() {},
};
```

由于类的方法都定义在<code style="color:#ea4335">prototype</code>对象上面,所以类的新方法可以添加在<code style="color:#ea4335">prototype</code>对象上面.

<code style="color:#ea4335">Object.assign()</code>方法可以很方便地一次向类添加多个方法

```js
Object.assign(Point.prototype, {
    toShit(){
        console.log("why invoke me? you this piece of shit");
    },
    toShit2(){}
  });

let point1 = new Point(1,2);
point1.toShit();
```

类和ES5行为不一致的点:

- 类的内部所有定义的方法,都是不可枚举的(non-enumerable)
- ES5构造函数内部定义的方法是可枚举的

```js
class Point {
  constructor(x, y) {
    // ...
  }
  toString() {
    // ...
  }
}
Object.keys(Point.prototype)
// []
Object.getOwnPropertyNames(Point.prototype)
// ["constructor","toString"]


var Point = function (x, y) {
  // ...
};
Point.prototype.toString = function () {
  // ...
};
Object.keys(Point.prototype)
// ["toString"]
Object.getOwnPropertyNames(Point.prototype)
// ["constructor","toString"]
```

### 1.2 constructor方法

<code style="color:#ea4335">constructor()</code>方法是类的默认方法,通过<code style="color:#ea4335">new</code>命令生成对象实例时,自动调用该方法. 一个类必须有<code style="color:#ea4335">constructor()</code>方法,若没有显示定义,一个空的<code style="color:#ea4335">constructor()</code>方法会被默认添加

```js
class Point {
}

// 等同于
class Point {
  constructor() {}
}
```

<code style="color:#ea4335">constructor()</code>函数默认返回实例对象(即<code style="color:#ea4335">this</code>),完全可以指定返回的另外一个对象

```js
class Foo {
  constructor() {
    return Object.create(null);
  }
}

new Foo() instanceof Foo
// false
```

类跟普通函数的另一个区别:

类必须使用<code style="color:#ea4335">new</code>才可以执行,后者不用<code style="color:#ea4335">new</code>也可以执行

```js
class Foo {
  constructor() {
    return Object.create(null);
  }
}

Foo()
/**
  Uncaught TypeError: Class constructor Foo cannot be invoked without 'new'
 */
```
