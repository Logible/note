# Other common Event

- [Other common Event](#other-common-event)
  - [1. Resourse Event](#1-resourse-event)
    - [1.2 unload Event](#12-unload-event)
    - [1.3 load event and error event](#13-load-event-and-error-event)
  - [2. session history event](#2-session-history-event)
    - [2.1 pageshow event, pagehide event](#21-pageshow-event-pagehide-event)
  - [2.2 popstate event](#22-popstate-event)
    - [2.3 hashchange event](#23-hashchange-event)
  - [3. The event fo webpage status](#3-the-event-fo-webpage-status)
    - [3.1 DOMContentLoaded](#31-domcontentloaded)
    - [3.2 readystatechage event](#32-readystatechage-event)
  - [4.Window event](#4window-event)
    - [4.1 scroll event](#41-scroll-event)

## 1. Resourse Event

The beforeunload event is fired when the window, the document and its resources are about to be unloaded. The document is still visible and the event is still cancelable at this point.

**Example:**

```js
const beforeUnloadListener = (event) => {
  event.preventDefault();
  return event.returnValue = "Are you sure you want to exit?";
};

const nameInput = document.querySelector("#name");

nameInput.addEventListener("input", (event) => {
  if (event.target.value !== "") {
    addEventListener("beforeunload", beforeUnloadListener, {capture: true});
  } else {
    removeEventListener("beforeunload", beforeUnloadListener, {capture: true});
  }
});
```

**Note:**

According to the specification, to show the confirmation dialog an event handler should call preventDefault() on the event.

However note that not all browsers support this method, and some instead require the event handler to implement one of two legacy methods:

- assigning a string to the event's returnValue property
- returning a string from the event handler.

Once the <code style="color:#ea4335">beforeunload</code> event is used, the browser will not cache the current page.

### 1.2 unload Event

The unload event is fired when the document or a child resource is being unloaded. Its trigger sequence is arranged after <code style="color:#ea4335">beforeunload</code> and <code style="color:#ea4335">pagehide</code> events.

Warning:

Developers should avoid using this event.

### 1.3 load event and error event

- The <code style="color:#ea4335">load</code> event is triggered when the page or a resourse is successfully loaded. (The page or resource is loaded from the browser cache and does not trigger the load event.)
- The <code style="color:#ea4335">error</code> event is triggered when the page or a resourse fails to load.
- The <code style="color:#ea4335">abort</code> event is triggered when the user cancels the loading.

These three events are actually progress event, Not only occurs in the <code style="color:#ea4335">document</code> object but also occurs in various external resources.

## 2. session history event

### 2.1 pageshow event, pagehide event

By default, the browser caches the page in the current session, when the user click the "forword/backword" button, the brower loads the page from the caches.

- The <code style="color:#ea4335">pageshow</code> is triggered when the page loads, it includes:

- The first load

    Its trigger sequence is after the load event.

- Load from caches

    <code style="color:#ea4335">load</code> event will not trigger. Because the appearance of the webpage in the cache is usually the appearance of the listener function of the <code style="color:#ea4335">load</code> event after running. Similarly. The Javascript script initialized in the webpage (such as DOMContentLoaded) of the webpage will not be executed.

**Property:**

- <code style="color:#ea4335">persisted</code>

    It return a boolean value. When the page is first loaded, this property is <code style="color:#ea4335">false</code>. When the page is loaded from caches, this property is <code style="color:#ea4335">true</code>

```js
window.addEventListener('pageshow', function(event){
  if (event.persisted) {
    // ...
  }
});
```

- <code style="color:#ea4335">pagehide</code> event is similar to <code style="color:#ea4335">pageshow</code>, triggered when the user leaves the current page through the "forward/backward" botton.

**Property:**

- <code style="color:#ea4335">persisted</code>

Setting this property to <code style="color:#ea4335">true</code> means that the page is to be stored in the cache.

Setting <code style="color:#ea4335">false</code> means the page will not be saved in the cache.

If the page contains <code style="color:#ea4335">\<frame></code> or <code style="color:#ea4335">\<iframe></code> element, the pageshow event and pagehide event of the <code style="color:#ea4335">\<frame></code> page will both triggered before the main page.

## 2.2 popstate event

The <code style="color:#ea4335">popstate</code> triggered when the current record of the <code style="color:#ea4335">history</code> object of browser is explicitly switched.

---
to be studited

after learning history object.

---

### 2.3 hashchange event

**Properties:**

This interface also inherits the properties of its parent, Event.

- <code style="color:#ea4335">HashChangeEvent.newURL</code> Read only
The new URL to which the window is navigating.

- <code style="color:#ea4335">HashChangeEvent.oldURL</code> Read only
The previous URL from which the window was navigated.

```js
window.addEventListener('hashchange', myFunction);

function myFunction(e) {
/**
 * e.newURL: "http://127.0.0.1:5500/#shit"
 * e.oldURL: "http://127.0.0.1:5500/#part2"
 */
}
```

## 3. The event fo webpage status

### 3.1 DOMContentLoaded

The <code style="color:#ea4335">DOMContentLoaded</code> event fires when the initial HTML document has been completely loaded and parsed, without waiting for stylesheets, images, and subframes to finish loading.

Note:

The JavaScript script of the webpage is executed synchronously.

```js
document.addEventListener('DOMContentLoaded', function (event) {
  console.log('DOM生成');
});
```

### 3.2 readystatechage event

The <code style="color:#ea4335">readystatechange</code> event is fired when the readyState attribute of a document has changed.

## 4.Window event

### 4.1 scroll event
