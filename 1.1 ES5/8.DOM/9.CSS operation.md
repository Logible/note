# CSS operation

- [CSS operation](#css-operation)
  - [1. The style attribute of HTML element](#1-the-style-attribute-of-html-element)
  - [2.CSSStyleDeclaration interface](#2cssstyledeclaration-interface)
    - [2.1 Overview](#21-overview)
    - [2.2 CSSStyleDeclaration instance properties](#22-cssstyledeclaration-instance-properties)
    - [2.3 The instance method of CSSStyleDeclaration](#23-the-instance-method-of-cssstyledeclaration)
  - [3.CSS module detection](#3css-module-detection)
  - [4.CSS object](#4css-object)
    - [4.2 CSS.supports()](#42-csssupports)
  - [5.window.getComputedStyle()](#5windowgetcomputedstyle)
  - [6.CSS pseudo-element](#6css-pseudo-element)
  - [7.StyleSheet interface](#7stylesheet-interface)
    - [7.1 Overview](#71-overview)

## 1. The style attribute of HTML element

The easiest way to manipulate CSS styles is to use <code style="color:#ea4335">getAttribute()</code> method,<code style="color:#ea4335">setAttribute()</code> method and <code style="color:#ea4335">removeAttribute</code> method of web page element nodes, directly read and write or delete the <code style="color:#ea4335">style</code> attribute of web page element.

```JS
shitdiv.setAttribute(
    'style',
    'background-color:red;' + 'border:1px solid black;' +
    'color: #000'
);
```

## 2.CSSStyleDeclaration interface

### 2.1 Overview

The <code style="color:#ea4335">CSSStyleDeclaration</code> object can be exposed using three different APIs:

- Via <code style="color:#ea4335">HTMLElement.style</code>, which deals with the inline styles of single element (e.g.,<code style="color:#ea4335">\<div style='...'></code>)
- Via the <code style="color:#ea4335">CSSStyleSheet</code> API. For example, <code style="color:#ea4335">document.styleSheets[0].cssRules[0].style</code> returns a <code style="color:#ea4335">CSSStyleDeclaration</code> object on the first CSS rule in the document's first stylesheet.
- Via <code style="color:#ea4335">Window.getComputedStyle()</code>, which exposes the <code style="color:#ea4335">CSSStyleDeclaration</code> object as a **read-only** interface.

The CSSStyle interface can read and write directly the style attributes of the CSS.

However, the hyphen needs to be changed to camel spelling. If the CSS attribute name is a JavaScript reserved word, the string css needs to be added before the rule name(e.g. <code style="color:#ea4335">float</code> is written as cssFloat).

```js
let divStyle = document.getElementById('shitdiv').style;
let backgroundColor = divStyle.backgroundColor // red
let border = divStyle.border // 1px solid black
let height = divStyle.height // 100px
let width = divStyle.width // 100px;
```

### 2.2 CSSStyleDeclaration instance properties

1. CSSStyleDeclaration.cssText

    The <code style="color:#ea4335">CSSStyleDeclaration.cssText</code> attribute is used to read and write all style declaration texts of the current rule.

    The easiest way to delete all inline styles of an element is to set <code style="color:#ea4335">cssText</code> to an empty string.

    ```js
    let divStyle = document.getElementById('richdiv').style;
    divStyle.cssText = 'background-color: red';
    divStyle.cssText = '';
    ```

2. CSSStyleDeclaration.length

    The <code style="color:#ea4335">CSSStyleDeclaration.length</code> attribute return an integer value representing how many style declarations the current rule contains.

    ```js
    let divStyle = document.getElementById('richdiv').style;
    let length = divStyle.length; //0
    divStyle.cssText = 'background-color: red';
    let length1 = divStyle.length; //1
    ```

3. CSSStyleDeclaration.parentRule

The <code style="color:#ea4335">CSSStyleDeclaration.parentRule</code> attribute returns the style block (CSSRule instance) to which the current rule belongs. If there is no style block to which it belongs, this attribute returns <code style="color:#ea4335">null</code>.

This attribute is read-only and is only meaningful when using the CSSRule interface.

```js
var declaration = document.styleSheets[0].rules[0].style;
declaration.parentRule === document.styleSheets[0].rules[0]
// true
```

---
question

what is the CSSRule interface?

---

### 2.3 The instance method of CSSStyleDeclaration

The attribute name should be written as hyphen type.

1. CSSStyleDeclaration.getPropertyPriority()

    Returns the optional priority, "improtant"

    ```js
    // HTML 代码为
    // <div id="myDiv" style="margin: 10px!important; color: red;"/>
    var style = document.getElementById('myDiv').style;
    style.margin // "10px"
    style.getPropertyPriority('margin') // "important"
    style.getPropertyPriority('color') // ""
    ```

2. CSSStyleDeclaration.getPropertyValue()

    Returns the property value given a property name.

    ```js
    // HTML 代码为
    // <div id="myDiv" style="margin: 10px!important; color: red;"/>
    var style = document.getElementById('myDiv').style;
    style.margin // "10px"
    style.getPropertyValue("margin") // "10px"
    ```

3. CSSStyleDeclaration.item()

    Returns a CSS property name by its index, or the empty string if the index is out-of-bounds.

    ```js
    // HTML 代码为
    // <div id="myDiv" style="color: red; background-color: white;"/>
    var style = document.getElementById('myDiv').style;
    style.item(0) // "color"
    style.item(1) // "background-color"
    ```

4. CSSStyleDeclaration.removeProperty()

    Removes a property from a CSS style declaration object.

    ```js
    // HTML 代码为
    // <div id="myDiv" style="color: red; background-color: white;">
    //   111
    // </div>
    var style = document.getElementById('myDiv').style;
    style.removeProperty('color') // 'red'
    // HTML 代码变为
    // <div id="myDiv" style="background-color: white;">
    ```

5. CSSStyleDeclaration.setProperty

Modifies an existing CSS property or create a new CSS property in the declaration block.

**Parameters:**

propertyName

A <code style="color:#ea4335">DOMString</code> representing the CSS property name (hyphen case) to be modified.

value Optional

A <code style="color:#ea4335">DOMstring</code> contanining the new property value. If not specified, treated as the empty string.

priority Optional

A <code style="color:#ea4335">DOMString</code> allowing the "important" CSS priority to be set. If not specified, treated as the empty string. The following value are aceept:

- String value "important"
- keyword undefined
- String empty value ""

```js
// HTML 代码为
// <div id="myDiv" style="color: red; background-color: white;">
//   111
// </div>
var style = document.getElementById('myDiv').style;
style.setProperty('border', '1px solid blue');
```

## 3.CSS module detection

Sometimes, it is necessary to know whether the current browser supports a certain module, this is called "CSS module detection"

A more generally applicable method is to determine whether a certain attribute value of style object of an element is string.

- If the CSS attribute does exist, it will return a stirng.
- Even if the property is not actually set, an empty string will be returned.
- If the CSS attribute does't exist, it will return <code style="color:#ea4335">undefined</code>.

```js
typeof element.style.transform === 'string';
document.body.style['maxWidth'] // ""
document.body.style['maximumWidth'] // undefined
```

## 4.CSS object

The <code style="color:#ea4335">CSS.escape</code> method is used to escape special characters in CSS selectors.

Sometimes, the <code style="color:#ea4335">id</code> attribute of a certain element contains a <code style="color:#ea4335">#</code> sign, this character has a special meaning in the CSS seletor. It can't be written directly as <code style="color:#ea4335">document.querySelector</code>, can only be written as <code style="color:#ea4335">document.querySelector('#foo\\\\#bar')</code>. The reason why double slashes must be used here is that the single-quoted string itself escapses the slash once.

The <code style="color:#ea4335">CSS.escape</code> method is used to escape those special characters.

```js
document.querySelector('#' + CSS.escape('foo#bar'))
```

### 4.2 CSS.supports()

The <code style="color:#ea4335">CSS.supports</code> method return a boolean value indicating that whether the current environment supports a certain CSS rule.

There are two ways to write its parameters.

- The first is that the first parameter is the attribute name, the second parameter is the attribute value
- The second is the entire parameter is a complete line of CSS statement.

**Note:**

The second method of writing cannot have a semicolon at the end of the parameter, otherwise the result will be inaccurate.

```js
// 第一种写法
CSS.supports('transform-origin', '5px') // true

// 第二种写法
CSS.supports('display: table-cell') // true
CSS.supports('display: table-cell;') // false
```

## 5.window.getComputedStyle()

The <code style="color:#ea4335">inline style</code> has the highest proprity, changing the inline style will usually be reflected immediately. However, the final style of web page elements is calculated based on various rules. Therefore, if you want to get the actual style of the element, just reading the inline style is not enough,need to get the style rules finally calculated by the browser.

The <code style="color:#ea4335">windows.getComputeStyle</code> method is used to return the final rule calculated by the browser.

**Parameter:**

- element

    The <code style="color:#ea4335">Element</code> for which to get the computed style.

- pseudoElt Optional

    A stirng specifying the pseudo-element to match. Omitted (or <code style="color:#ea4335">null</code>) for real element.

**return value:**

A live <code style="color:#ea4335">CSSStyleDeclaration</code> object, contains the final style information of the specified node.

**Example:**

```js
let richStyle = document.getElementById('richdiv');
var styleObj = window.getComputedStyle(richStyle);
let backgroundColor = styleObj.backgroundColor;
let color = styleObj.color;
/**
 * backgroundColor: "rgb(6, 68, 125)"
 * color: "rgb(255, 255, 255)"
 */
```

**Notes:**

- The returned <code style="color:#ea4335">CSSStyleDeclaration</code> object contanis active values for CSS property longhand names. For example, <code style="color:#ea4335">border-bottom-width</code> instead of the <code style="color:#ea4335">border-width</code> and <code style="color:#ea4335">border</code> shorthand property names. It is safest to query values with only longhand names like <code style="color:#ea4335">fron-size</code>. Shorthand names like <code style="color:#ea4335">font</code> will not work with most browsers.
- CSS property values may be accessed using the <code style="color:#ea4335">getPropertyValue(proName)</code> API or by indexing directly into the object such as <code style="color:#ea4335">obj['z-index']</code> or <code style="color:#ea4335">obj.zIndex</code>.
- The CSS values returned by the <code style="color:#ea4335">CSSStyleDeclaration</code> instance are all absolute units.e.g.
  - The length is in pixel units (the return value includes the px suffix)
  - The color is in rgb(#,#,#) or rgba(#,#,#,#) format.

## 6.CSS pseudo-element

For pseudo-element, see the <1.番外篇>

You can get the pseudo-element from <code style="color:#ea4335">window.getComputeStyle</code>

**Example:**

```js
let richStyle = document.getElementById('richdiv');
let hoverColor = window.getComputedStyle(richStyle,':hover').backgroundColor;
let hoverColor2 = window.getComputedStyle(richStyle,':hover').getPropertyValue('background-color');
```

## 7.StyleSheet interface

### 7.1 Overview

The <code style="color:#ea4335">StyleSheet</code> represents the style sheet of a web page, which contains the style sheet loaded by the <code style="color:#ea4335">\<link></code> and the style sheet embedded in the <code style="color:#ea4335">\<style></code> element.

The <code style="color:#ea4335">styleSheets</code> attribute of the <code style="color:#ea4335">document</code> object can return all <code style="color:#ea4335">StyleSheet</code> instances (i.e. all style sheets) of the current page. It is a array-like object.

```js
let richStyle = document.getElementById('richdiv');
let sheets = document.styleSheets;
/**
 * 0: CSSStyleSheet {ownerRule: null, cssRules: CSSRuleList, rules: CSSRuleList, type: 'text/css', href: null, …}
 * 1: CSSStyleSheet {ownerRule: null, cssRules: CSSRuleList, rules: CSSRuleList, type: 'text/css', href: 'http://127.0.0.1:5500/#', …}
 * length: 2
 * [[Prototype]]: StyleSheetList
 */
```

If it is a style sheet embedded in the <code style="color:#ea4335">\<style></code> element
there is another method to get the <code style="color:#ea4335">StyleSheet</code> instance, that is the <code style="color:#ea4335">sheet</code> attribute of this element node.

```js
// HTML 代码为 <style id="myStyle"></style>
var myStyleSheet = document.getElementById('myStyle').sheet;
myStyleSheet instanceof StyleSheet // true
```

Strictly speaking, the <code style="color:#ea4335">StyleSheet</code> interface includes not only webpage style sheet, but also XML document style sheet. Therefore, it has a subclass <code style="color:#ea4335">CSSStyleSheet</code> representing the CSS style sheet of webpage.

The style sheet we got in the webpage is actually an instance of <code style="color:#ea4335">CSSStyleSheet</code>.
