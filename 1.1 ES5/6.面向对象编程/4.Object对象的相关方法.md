# Objectå¯¹è±¡çš„ç›¸å…³æ–¹æ³•

- [Objectå¯¹è±¡çš„ç›¸å…³æ–¹æ³•](#objectå¯¹è±¡çš„ç›¸å…³æ–¹æ³•)
  - [1.Object.getPrototypeOf()](#1objectgetprototypeof)
  - [2.Object.setPrototypeOf()](#2objectsetprototypeof)
  - [3.Object.create()](#3objectcreate)
  - [4.Object.prototype.isPrototypeOf()](#4objectprototypeisprototypeof)
  - [5.Object.prototype.\_\_proto\_\_](#5objectprototype__proto__)
  - [6.è·å–åŸå‹å¯¹è±¡æ–¹æ³•çš„æ¯”è¾ƒ](#6è·å–åŸå‹å¯¹è±¡æ–¹æ³•çš„æ¯”è¾ƒ)
  - [7.Object.getOwnPropertyNames()](#7objectgetownpropertynames)
  - [8.Object.prototype.hasOwnProperty()](#8objectprototypehasownproperty)
  - [10.å¯¹è±¡çš„æ‹·è´](#10å¯¹è±¡çš„æ‹·è´)

## 1.Object.getPrototypeOf()

<code style="color:#ea4335">Object.getPrototypeOf</code>æ–¹æ³•è¿”å›å‚æ•°å¯¹è±¡çš„åŸå‹,è¿™æ˜¯è·å–åŸå‹å¯¹è±¡çš„æ ‡å‡†æ–¹æ³•

```js
var F = function () {};
var f = new F();
Object.getPrototypeOf(f) === F.prototype // true
```

ä¸‹é¢æ˜¯å‡ ç§ç‰¹æ®Šçš„åŸå‹

```js
// ç©ºå¯¹è±¡çš„åŸå‹æ˜¯ Object.prototype
Object.getPrototypeOf({}) === Object.prototype // true

// Object.prototype çš„åŸå‹æ˜¯ null
Object.getPrototypeOf(Object.prototype) === null // true

// å‡½æ•°çš„åŸå‹æ˜¯ Function.prototype
function f() {}
Object.getPrototypeOf(f) === Function.prototype // true
```

## 2.Object.setPrototypeOf()

<code style="color:#ea4335">Object.setPrototypeOf</code>æ–¹æ³•ä¸ºå‚æ•°å¯¹æ•°è®¾ç½®åŸå‹,è¿”å›è¯¥å‚æ•°å¯¹è±¡,å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°

- ç¬¬ä¸€ä¸ªæ˜¯ç°æœ‰å¯¹è±¡
- ç¬¬äºŒä¸ªæ˜¯åŸå‹å¯¹è±¡

```js
var a = {};
var b = {x: 1};
Object.setPrototypeOf(a, b);

Object.getPrototypeOf(a) === b // true
a.x // 1
```

<code style="color:#ea4335">new</code>å‘½ä»¤å¯ä»¥ä½¿ç”¨<code style="color:#ea4335">Object.setPrototypeOf</code>æ–¹æ³•æ¨¡æ‹Ÿ

<code style="color:#ea4335">new</code>å‘½ä»¤æ–°å»ºå®ä¾‹å¯¹è±¡,å¯åˆ†ä¸ºä¸¤æ­¥

- ç¬¬ä¸€æ­¥,å°†ä¸€ä¸ªç©ºå¯¹è±¡çš„åŸå‹è®¾ç½®ä¸ºæ„é€ å‡½æ•°çš„<code style="color:#ea4335">prototype</code>å±æ€§
- ç¬¬äºŒæ­¥,å°†æ„é€ å‡½æ•°å†…éƒ¨çš„<code style="color:#ea4335">this</code>ç»‘å®šè¿™ä¸ªç©ºå¯¹è±¡,ç„¶åæ‰§è¡Œæ„é€ å‡½æ•°,ä½¿å¾—å®šä¹‰åœ¨<code style="color:#ea4335">this</code>ä¸Šé¢çš„æ–¹æ³•å’Œå±æ€§,éƒ½è½¬ç§»åˆ°è¿™ä¸ªç©ºå¯¹è±¡ä¸Š

```js
var F = function(){
  this.foo = 'bar';
}

var f = new F();
//ç­‰åŒäº

var f = Object.setPrototypeOf({},F.prototype);
F.call(f);
```

## 3.Object.create()

<code style="color:#ea4335">Object</code>ç”¨äºä»ä¸€ä¸ªå®ä¾‹å¯¹è±¡,ç”Ÿæˆå¦ä¸€ä¸ªå®ä¾‹å¯¹è±¡

```js
// åŸå‹å¯¹è±¡
var A = {
  print: function () {
    console.log('hello');
  }
};

// å®ä¾‹å¯¹è±¡
var B = Object.create(A);

Object.getPrototypeOf(B) === A // true
B.print() // hello
B.print === A.print // true
```

å®é™…ä¸Š,<code style="color:#ea4335">Object.create()</code>æ–¹æ³•å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç ä»£æ›¿

```js
if (typeof Object.create !== 'function') {
  Object.create = function (obj) {
    function F() {}         //æ–°å»ºæ„é€ å‡½æ•°
    F.prototype = obj;      //è®©F.prototypeå±æ€§æŒ‡å‘å‚æ•°å¯¹è±¡obj
    return new F();         //è¿”å›ä¸€ä¸ªF()çš„å®ä¾‹
  };
}
```

ä¸‹é¢ä¸‰ç§æ–¹å¼ç”Ÿæˆçš„æ–°å¯¹è±¡æ˜¯ç­‰ä»·çš„

```js
var obj1 = Object.create({});
var obj2 = Object.create(Object.prototype);
var obj3 = new Object();
```

- è‹¥æƒ³è¦ç”Ÿæˆä¸€ä¸ªä¸ç»§æ‰¿ä»»ä½•å±æ€§(å¦‚æ²¡æœ‰<code style="color:#ea4335">toString()</code>å’Œ<code style="color:#ea4335">valueOf()</code>æ–¹æ³•çš„å¯¹è±¡),å¯ä»¥å°†<code style="color:#ea4335">Object.create()</code>å‚æ•°è®¾ä¸º<code style="color:#ea4335">null</code>
- <code style="color:#ea4335">Object.create()</code>æ–¹æ³•å‚æ•°ä¸èƒ½ä¸ºç©º,æˆ–è€…ä¸æ˜¯å¯¹è±¡,å¦åˆ™ä¼šæŠ¥é”™(å³å¿…é¡»æä¾›å¯¹è±¡åŸå‹)
- <code style="color:#ea4335">Object.create()</code>æ–¹æ³•ç”Ÿæˆçš„å¯¹è±¡,ç»§æ‰¿äº†å®ƒçš„åŸå‹å¯¹è±¡çš„æ„é€ å‡½æ•°

```js
var obj = Object.create(null);

obj.valueOf()
// TypeError: Object [object Object] has no method 'valueOf'

Object.create()
// TypeError: Object prototype may only be an Object or null
Object.create(123)
// TypeError: Object prototype may only be an Object or null

function A() {}
var a = new A();
var b = Object.create(a);

b.constructor === A // true
b instanceof A // true
```

å› ä¸º<code style="color:#ea4335">Object.create()</code>æ–¹æ³•ç”Ÿæˆçš„æ–°å¯¹è±¡,åŠ¨æ€ç»§æ‰¿äº†åŸå‹.åœ¨åŸå‹ä¸Šæ·»åŠ æˆ–ä¿®æ”¹ä»»ä½•æ–¹æ³•,ä¼šç«‹åˆ»åæ˜ åœ¨æ–°å¯¹è±¡ä¹‹ä¸Š

```js
var obj1 = { p: 1 };
var obj2 = Object.create(obj1);

obj1.p = 2;
obj2.p // 2
```

<code style="color:#ea4335">Object.create()</code>æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°. è¯¥å‚æ•°æ˜¯ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡,å®ƒæ‰€æè¿°çš„å¯¹è±¡å±æ€§ä¼šæ·»åŠ åˆ°å®ä¾‹å¯¹è±¡,ä½œä¸ºå¯¹è±¡è‡ªèº«çš„å±æ€§

```js
var obj = Object.create({}, {
  p1: {
    value: 123,
    enumerable: true,
    configurable: true,
    writable: true,
  },
  p2: {
    value: 'abc',
    enumerable: true,
    configurable: true,
    writable: true,
  }
});

// ç­‰åŒäº
var obj = Object.create({});
obj.p1 = 123;
obj.p2 = 'abc';

```

## 4.Object.prototype.isPrototypeOf()

å®ä¾‹å¯¹è±¡çš„<code style="color:#ea4335">isPrototypeOf</code>æ–¹æ³•,ç”¨æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºå‚æ•°çš„åŸå‹

```js
Object.prototype.isPrototypeOf({}) // true
Object.prototype.isPrototypeOf([]) // true
Object.prototype.isPrototypeOf(/xyz/) // true
Object.prototype.isPrototypeOf(Object.create(null)) // false
```

ç”±äº<code style="color:#ea4335">Object.prototype</code>å¤„äºåŸå‹é“¾çš„æœ€é¡¶ç«¯,æ‰€ä»¥å¯¹å„ç§å®ä¾‹éƒ½è¿”å›<code style="color:#ea4335">true</code>.åªæœ‰ç›´æ¥ç»§æ‰¿è‡ª<code style="color:#ea4335">null</code>çš„å¯¹è±¡é™¤å¤–

## 5.Object.prototype.\_\_proto\_\_

å®ä¾‹å¯¹è±¡çš„<code style="color:#ea4335">\_\_proto\_\_</code>å±æ€§(å‰åå„ä¸¤ä¸ªä¸‹åˆ’çº¿),è¿”å›è¯¥å¯¹è±¡çš„åŸå‹,è¯¥å±æ€§å¯è¯»å†™

```js
var obj = {};
var p = {};

obj.__proto__ = p;
Object.getPrototypeOf(obj) === p // true
```

æ ¹æ®è¯­è¨€æ ‡å‡†,<code style="color:#ea4335">\_\_proto\_\_</code>å±æ€§åªæœ‰æµè§ˆå™¨æ‰éœ€è¦éƒ¨ç½²,å…¶ä»–ç¯å¢ƒå¯ä»¥æ²¡æœ‰è¿™ä¸ªå±æ€§.å®ƒå‰åçš„ä¸¤æ ¹ä¸‹åˆ’çº¿,è¡¨æ˜å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå†…éƒ¨å±æ€§,ä¸åº”è¯¥å¯¹ä½¿ç”¨è€…æš´éœ²

å› æ­¤,åº”å°½é‡å°‘ç”¨è¿™ä¸ªå±æ€§,è€Œæ˜¯ä½¿ç”¨<code style="color:#ea4335">Object.getPrototypeOf</code>å’Œ<code style="color:#ea4335">Object.setPrototypeOf()</code>è¿›è¡ŒåŸå‹å¯¹è±¡çš„è¯»å†™æ“ä½œ

åŸå‹é“¾å¯ç”¨<code style="color:#ea4335">\_\_proto\_\_</code>ç›´è§‚åœ°è¡¨ç¤º

```js
var A = {
  name: 'å¼ ä¸‰'
};
var B = {
  name: 'æå››'
};

var proto = {
  print: function () {
    console.log(this.name);
  }
};

A.__proto__ = proto;
B.__proto__ = proto;

A.print() // å¼ ä¸‰
B.print() // æå››

A.print === B.print // true
A.print === proto.print // true
B.print === proto.print // true
```

## 6.è·å–åŸå‹å¯¹è±¡æ–¹æ³•çš„æ¯”è¾ƒ

<code style="color:#ea4335">\_\_proto\_\_</code>å±æ€§æŒ‡å‘å½“å‰å¯¹è±¡çš„åŸå‹å¯¹è±¡,å³æ„é€ å‡½æ•°çš„<code style="color:#ea4335">prototype</code>å±æ€§

```js
var obj = new Object();

obj.__proto__ === Object.prototype
// true
obj.__proto__ === obj.constructor.prototype
// true
```

å› æ­¤,è·å–å®ä¾‹å¯¹è±¡çš„<code style="color:#ea4335">obj</code>,æœ‰ä¸‰ç§æ–¹æ³•

- <code style="color:#ea4335">obj.\_\_proto\_\_</code>
- <code style="color:#ea4335">obj.constructor.prototype</code>
- <code style="color:#ea4335">Object.getPrototypeOf(obj)</code>

ä¸‰ç§æ–¹æ³•ä¹‹ä¸­,å‰ä¸¤ç§éƒ½ä¸å¯é 

- <code style="color:#ea4335">\_\_proto\_\_</code>å±æ€§åªæœ‰åœ¨æµè§ˆå™¨æ‰éœ€è¦éƒ¨ç½²,å…¶ä»–ç¯å¢ƒå¯ä»¥ä¸éƒ¨ç½²
- <code style="color:#ea4335">obj.constructor.prototype</code>åœ¨æ‰‹åŠ¨æ”¹å˜åŸå‹å¯¹è±¡æ—¶,å¯èƒ½ä¼šå¤±æ•ˆ

```js
var P = function () {};
var p = new P();

var C = function () {};
C.prototype = p;
//ğŸ‘‰ C.prototype.constructor = C;

var c = new C();

console.log(c.constructor.prototype === p);     //false
console.log(c.__protp__ === p);                 //false
console.log(Object.getPrototypeOf(c) === p);    //true
```

ğŸ‘†ä»£ç ä¸­,æ„é€ å‡½æ•°<code style="color:#ea4335">C</code>çš„åŸå‹å¯¹è±¡è¢«æ”¹æˆäº†<code style="color:#ea4335">p</code>,ä½†æ˜¯å®ä¾‹å¯¹è±¡çš„<code style="color:#ea4335">C.prototype.constructor</code>å´æ²¡æœ‰æŒ‡å‘<code style="color:#ea4335">p</code>,æ•…åœ¨æ”¹å˜åŸå‹å¯¹è±¡æ—¶,ä¸€èˆ¬è¦è®¾ç½®<code style="color:#ea4335">constructor</code>å±æ€§

ä½†<code style="color:#ea4335">Object.getPrototypeOf</code>å¯ä»¥è·å–åˆ°æ­£ç¡®çš„åŸå‹å¯¹è±¡

## 7.Object.getOwnPropertyNames()

<code style="color:#ea4335">Object.getOwnPropertyNames()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡æœ¬èº«çš„æ‰€æœ‰å±æ€§çš„é”®åï¼Œä¸åŒ…å«ç»§æ‰¿çš„å±æ€§é”®å

```js
Object.getOwnPropertyNames(Date)
// ["parse", "arguments", "UTC", "caller", "name", "prototype", "now", "length"]
```

å¯¹è±¡æœ¬èº«çš„å±æ€§ä¹‹ä¸­,æœ‰çš„æ˜¯å¯ä»¥éå†çš„(enumberable),æœ‰çš„æ˜¯ä¸å¯éå†çš„.<code style="color:#ea4335">Object.getOwnPropertyNames()</code>è¿”å›æ‰€æœ‰é”®å,ä¸ç®¡æ˜¯å¦å¯ä»¥éå†.

è‹¥åªè·å–å¯ä»¥éå†çš„å±æ€§,ä½¿ç”¨<code style="color:#ea4335">Object.keys()</code>æ–¹æ³•

```js
Object.keys(Date) // []
```

## 8.Object.prototype.hasOwnProperty()

å¯¹è±¡å®ä¾‹çš„<code style="color:#ea4335">hasOwnProperty()</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼,ç”¨äºåˆ¤æ–­æŸä¸ªå±æ€§å®šä¹‰åœ¨å¯¹è±¡è‡ªèº«,è¿˜æ˜¯å®šä¹‰åœ¨åŸå‹é“¾ä¸Š

```js
Date.hasOwnProperty('length') // true
Date.hasOwnProperty('toString') // false
```

<code style="color:#fbbc05">Tips:</code>

<code style="color:#ea4335">hasOwnProperty</code>æ˜¯JavaScriptä¹‹ä¸­å”¯ä¸€ä¸€ä¸ªå¤„ç†å¯¹è±¡å±æ€§æ—¶,ä¸ä¼šéå†åŸå‹é“¾çš„æ–¹æ³•

## 10.å¯¹è±¡çš„æ‹·è´

è‹¥è¦copyä¸€ä¸ªå¯¹è±¡,éœ€è¦åšåˆ°ä¸‹é¢ä¸¤ä»¶äº‹æƒ…

- ç¡®ä¿æ‹·è´åçš„å¯¹è±¡,ä¸åŸå¯¹è±¡å…·æœ‰åŒæ ·çš„åŸå‹
- ç¡®ä¿æ‹·è´åçš„å¯¹è±¡,ä¸åŸå¯¹è±¡å…·æœ‰åŒæ ·çš„å®ä¾‹å±æ€§

ä¸‹é¢ä»£ç ä¾¿æ˜¯æ ¹æ®ä¸Šé¢ä¸¤ç‚¹,å®ç°çš„æ‹·è´å‡½æ•°

```js
function copyObject(orig) {
  return Object.create(
    Object.getPrototypeOf(orig),
    Object.getOwnPropertyDescriptors(orig)
  );
}
```
