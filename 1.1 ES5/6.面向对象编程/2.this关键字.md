# thiså…³é”®å­—

- [thiså…³é”®å­—](#thiså…³é”®å­—)
  - [1. æ¶µä¹‰](#1-æ¶µä¹‰)
  - [2.å®è´¨](#2å®è´¨)
  - [3.ä½¿ç”¨åœºåˆ](#3ä½¿ç”¨åœºåˆ)
    - [3.1 å…¨å±€ç¯å¢ƒ](#31-å…¨å±€ç¯å¢ƒ)
    - [3.2 æ„é€ å‡½æ•°](#32-æ„é€ å‡½æ•°)
    - [3.3 å¯¹è±¡çš„æ–¹æ³•](#33-å¯¹è±¡çš„æ–¹æ³•)
  - [4.ä½¿ç”¨æ³¨æ„ç‚¹](#4ä½¿ç”¨æ³¨æ„ç‚¹)
    - [4.1 é¿å…å¤šå±‚this](#41-é¿å…å¤šå±‚this)
    - [4.2 é¿å…æ•°ç»„å¤„ç†æ–¹æ³•ä¸­çš„this](#42-é¿å…æ•°ç»„å¤„ç†æ–¹æ³•ä¸­çš„this)
    - [4.3 é¿å…å›è°ƒå‡½æ•°ä¸­çš„this](#43-é¿å…å›è°ƒå‡½æ•°ä¸­çš„this)
  - [**5.ç»‘å®šthisçš„æ–¹æ³•**](#5ç»‘å®šthisçš„æ–¹æ³•)
    - [5.1 Function.prototype.call()](#51-functionprototypecall)
    - [5.2 Function.prototype.apply()](#52-functionprototypeapply)
    - [5.3 Function.prototype.bind()](#53-functionprototypebind)

## 1. æ¶µä¹‰

å‰ä¸€ç« æåˆ°:<code style="color:#ea4335">this</code>å¯ä»¥ç”¨åœ¨æ„é€ å‡½æ•°ä¹‹ä¸­,è¡¨ç¤ºå®ä¾‹å¯¹è±¡. é™¤æ­¤ä¹‹å¤–,<code style="color:#ea4335">this</code>è¿˜å¯ä»¥ç”¨åœ¨åˆ«çš„åœºåˆ

æ‰€æœ‰åœºåˆ<code style="color:#ea4335">this</code>çš„å…±åŒç‚¹:å®ƒæ€»æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡. ä¾‹å­:

```js
var person = {
  name: 'å¼ ä¸‰',
  describe: function () {
    return 'å§“åï¼š'+ this.name;
  }
};

person.describe()
// "å§“åï¼šå¼ ä¸‰"
```

<code style="color:#ea4335">this.name</code>åœ¨<code style="color:#ea4335">describe</code>æ–¹æ³•ä¸­è°ƒç”¨,è€Œ<code style="color:#ea4335">describe</code>æ–¹æ³•æ‰€åœ¨çš„å½“å‰å¯¹è±¡æ˜¯<code style="color:#ea4335">person</code>,å› æ­¤<code style="color:#ea4335">this</code>æŒ‡å‘<code style="color:#ea4335">person</code>

ç”±äºå¯¹è±¡çš„å±æ€§å¯ä»¥èµ‹å€¼ç»™å¦ä¸€ä¸ªå¯¹è±¡,æ‰€ä»¥å±æ€§æ‰€åœ¨çš„å½“å‰å¯¹è±¡æ˜¯å¯å˜çš„, å³<code style="color:#ea4335">this</code>çš„æŒ‡å‘æ˜¯å¯å˜çš„

```js
var A = {
  name: 'å¼ ä¸‰',
  describe: function () {
    return 'å§“åï¼š'+ this.name;
  }
};

var B = {
  name: 'æå››'
};

B.describe = A.describe;
B.describe()
// "å§“åï¼šæå››"
```

<code style="color:#ea4335">A.describe</code>å±æ€§è¢«èµ‹ç»™<code style="color:#ea4335">B</code>,äºæ˜¯<code style="color:#ea4335">B.describe</code>å°±è¡¨ç¤º<code style="color:#ea4335">describe</code>æ–¹æ³•æ‰€åœ¨çš„å½“å‰å¯¹è±¡æ˜¯<code style="color:#ea4335">B</code>

ä¸€ä¸ªç½‘é¡µç¼–ç¨‹çš„ä¾‹å­,å…¶ä¸­<code style="color:#ea4335">
this</code>ä»£è¡¨ä¼ å…¥å½“å‰å¯¹è±¡(å³æ–‡æœ¬æ¡†),ç„¶åå°±å¯ä»¥ä»<code style="color:#ea4335">this.value</code>ä¸Šé¢è¯»åˆ°ç”¨æˆ·çš„è¾“å…¥å€¼

```js
<input type="text" name="age" size=3 onChange="validate(this, 18, 99);">

<script>
function validate(obj, lowval, hival){
  if ((obj.value < lowval) || (obj.value > hival))
    console.log('Invalid Value!');
}
</script>
```

## 2.å®è´¨

JavaScriptè¯­è¨€ä¹‹æ‰€ä»¥æœ‰thisçš„è®¾è®¡,è·Ÿå†…å­˜é‡Œé¢çš„æ•°æ®ç»“æ„æœ‰å…³ç³»

```js
var obj = { foo:  5 };
```

ä¸Šé¢çš„ä»£ç å°†ä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™å˜é‡<code style="color:#ea4335">obj</code>.JavaScriptå¼•æ“ä¼šå…ˆåœ¨å†…å­˜é‡Œé¢,ç”Ÿæˆä¸€ä¸ªå¯¹è±¡<code style="color:#ea4335">{foo:5}</code>.ç„¶åæŠŠè¿™ä¸ªå¯¹è±¡çš„å†…å­˜åœ°å€èµ‹å€¼ç»™å˜é‡<code style="color:#ea4335">obj</code>

ä¹Ÿçœ‹æ˜¯è¯´,å˜é‡<code style="color:#ea4335">obj</code>æ˜¯ä¸€ä¸ªåœ°å€.è‹¥è¦è¯»å–<code style="color:#ea4335">obj.foo</code>,å¼•æ“å…ˆä»<code style="color:#ea4335">obj</code>æ‹¿åˆ°å†…å­˜åœ°å€,ç„¶åä»è¯¥åœ°å€è¯»å–åŸå§‹çš„å¯¹è±¡,è¿”å›å®ƒçš„<code style="color:#ea4335">foo</code>å±æ€§

åŸå§‹çš„å¯¹è±¡ä»¥å­—å…¸ç»“æ„ä¿å­˜,æ¯ä¸€ä¸ªå±æ€§åéƒ½å¯¹åº”ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡,ä¸Šé¢ä¾‹å­çš„<code style="color:#ea4335">foo</code>å±æ€§,å®é™…ä¸Šæ˜¯ä»¥ä¸‹é¢çš„å½¢å¼ä¿å­˜çš„

```js
{
  foo: {
    [[value]]: 5
    [[writable]]: true
    [[enumerable]]: true
    [[configurable]]: true
  }
}
```

ä½†å¦‚æœå±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå‡½æ•°.å¼•æ“ä¼šå°†å‡½æ•°å•ç‹¬ä¿å­˜åœ¨å†…å­˜ä¸­,ç„¶åå†å°†å‡½æ•°çš„åœ°å€èµ‹å€¼ç»™<code style="color:#ea4335">foo</code>å±æ€§çš„<code style="color:#ea4335">value</code>å±æ€§

```js
var obj = { foo: function () {} };

{
  foo: {
    [[value]]: å‡½æ•°çš„åœ°å€
    ...
  }
}
```

ç”±äºå‡½æ•°æ˜¯ä¸€ä¸ªå•ç‹¬çš„å€¼,æ‰€ä»¥å®ƒå¯ä»¥åœ¨ä¸åŒçš„ç¯å¢ƒ(ä¸Šä¸‹æ–‡)æ‰§è¡Œ

```js
var f = function () {};
var obj = { f: f };

// å•ç‹¬æ‰§è¡Œ
f()

// obj ç¯å¢ƒæ‰§è¡Œ
obj.f()
```

JavaScriptå…è®¸åœ¨å‡½æ•°ä½“å†…éƒ¨,å¼•ç”¨å½“å‰ç¯å¢ƒçš„å…¶ä»–å˜é‡.ç”±äºå‡½æ•°å¯ä»¥åœ¨ä¸åŒçš„è¿è¡Œç¯å¢ƒä¸­æ‰§è¡Œ,æ‰€ä»¥éœ€è¦æœ‰ä¸€ç§æœºåˆ¶,èƒ½å¤Ÿåœ¨å‡½æ•°ä½“å†…éƒ¨è·å¾—å½“å‰çš„è¿è¡Œç¯å¢ƒ(context),æ‰€ä»¥<code style="color:#ea4335">this</code>å°±å‡ºç°äº†,å®ƒçš„è®¾è®¡ç›®çš„æ˜¯åœ¨å‡½æ•°ä½“å†…éƒ¨,æŒ‡ä»£å‡½æ•°å½“å‰çš„è¿è¡Œç¯å¢ƒ

```js
var f = function () {
  console.log(this.x);
}

var x = 1;
var obj = {
  f: f,
  x: 2,
};

// å•ç‹¬æ‰§è¡Œ
f() // 1

// obj ç¯å¢ƒæ‰§è¡Œ
obj.f() // 2
```

## 3.ä½¿ç”¨åœºåˆ

<code style="color:#ea4335">this</code>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä½¿ç”¨åœºåˆ

### 3.1 å…¨å±€ç¯å¢ƒ

å…¨å±€ç¯å¢ƒä½¿ç”¨<code style="color:#ea4335">this</code>,å®ƒæŒ‡çš„å°±æ˜¯é¡¶å±‚å¯¹è±¡<code style="color:#ea4335">window</code>

```js
this === window // true

function f() {
  console.log(this === window);
}
f() // true
```

ä¸ç®¡æ˜¯ä¸æ˜¯åœ¨å‡½æ•°å†…éƒ¨,åªè¦æ˜¯åœ¨å…¨å±€ç¯å¢ƒä¸‹è¿è¡Œ,<code style="color:#ea4335">this</code>æŒ‡çš„å°±æ˜¯é¡¶å±‚å¯¹è±¡<code style="color:#ea4335">window</code>

### 3.2 æ„é€ å‡½æ•°

æ„é€ å‡½æ•°ä¸­çš„<code style="color:#ea4335">this</code>,æŒ‡çš„æ˜¯å®ä¾‹å¯¹è±¡

```js
var Obj = function (p) {
  this.p = p;
};

var o = new Obj('Hello World!');
o.p // "Hello World!"
```

### 3.3 å¯¹è±¡çš„æ–¹æ³•

å¦‚æœå¯¹è±¡çš„æ–¹æ³•é‡Œé¢åŒ…å«<code style="color:#ea4335">this</code>,<code style="color:#ea4335">this</code>çš„æŒ‡å‘å°±æ˜¯æ–¹æ³•è¿è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡

è¯¥æ–¹æ³•èµ‹å€¼ç»™å¦ä¸€ä¸ªå¯¹è±¡,å°±ä¼šæ”¹å˜<code style="color:#ea4335">this</code>çš„æŒ‡å‘

```js
var obj ={
  foo: function () {
    console.log(this);
  }
};

obj.foo() // obj
```

ä¸Šé¢ä»£ç ä¸­,<code style="color:#ea4335">obj.foo</code>æ–¹æ³•æ‰§è¡Œæ—¶,å®ƒå†…éƒ¨çš„<code style="color:#ea4335">this</code>æŒ‡å‘<code style="color:#ea4335">obj</code>

ä½†ä¸‹é¢å‡ ç§ç”¨æ³•,éƒ½ä¼šæ”¹å˜<code style="color:#ea4335">this</code>çš„æŒ‡å‘

```js
// æƒ…å†µä¸€
(obj.foo = obj.foo)() // window
// æƒ…å†µäºŒ
(false || obj.foo)() // window
// æƒ…å†µä¸‰
(1, obj.foo)() // window


//ç›¸å½“äº
// æƒ…å†µä¸€
(obj.foo = function () {
  console.log(this);
})()
// ç­‰åŒäº
(function () {
  console.log(this);
})()

// æƒ…å†µäºŒ
(false || function () {
  console.log(this);
})()

// æƒ…å†µä¸‰
(1, function () {
  console.log(this);
})()

```

ä¸Šé¢ä»£ç ä¸­,<code style="color:#ea4335">obj.foo</code>å°±æ˜¯ä¸€ä¸ªå€¼,å½“è¿™ä¸ªå€¼çœŸæ­£è°ƒç”¨çš„æ—¶å€™,è¿è¡Œç¯å¢ƒå·²ç»ä¸æ˜¯<code style="color:#ea4335">obj</code>äº†,è€Œæ˜¯å…¨å±€ç¯å¢ƒ,å¤<code style="color:#ea4335">this</code>ä¸å†æŒ‡å‘<code style="color:#ea4335">obj</code>

åŸå› :

JavaScriptå¼•æ“å†…éƒ¨,<code style="color:#ea4335">obj</code>å’Œ<code style="color:#ea4335">obj.foo</code>å­˜å‚¨åœ¨ä¸¤ä¸ªå†…å­˜åœ°å€,ç§°ä¸ºåœ°å€ä¸€å’Œåœ°å€äºŒ.<code style="color:#ea4335">obj.foo()</code>è¿™æ ·è°ƒç”¨æ—¶,æ˜¯ä»åœ°å€ä¸€è°ƒç”¨åœ°å€äºŒ,å› æ­¤åœ°å€äºŒçš„è¿è¡Œç¯å¢ƒæ˜¯åœ°å€ä¸€

è€Œä¸Šé¢ä¸‰ç§æƒ…å†µ,éƒ½æ˜¯ç›´æ¥å–å‡ºåœ°å€äºŒè¿›è¡Œè°ƒç”¨,è¿™æ ·çš„è¯è¿è¡Œç¯å¢ƒå°±æ˜¯å…¨å±€ç¯å¢ƒ,å› æ­¤<code style="color:#ea4335">this</code>æŒ‡å‘å…¨å±€ç¯å¢ƒ

å¦‚æœ<code style="color:#ea4335">this</code>æ‰€åœ¨çš„æ–¹æ³•ä¸åœ¨å¯¹è±¡çš„ç¬¬ä¸€å±‚,è¿™æ—¶<code style="color:#ea4335">this</code>åªæ˜¯æŒ‡å‘å½“å‰ä¸€å±‚çš„å¯¹è±¡,è€Œä¸ä¼šç»§æ‰¿æ›´ä¸Šé¢çš„å±‚

```js
var a = {
  p: 'Hello',
  b: {
    m: function() {
      console.log(this.p);
    }
  }
};

a.b.m() // undefined
//ç­‰åŒäº
b.m()
```

å¦‚æœè¿™æ—¶å°†åµŒå¥—å¯¹è±¡å†…éƒ¨çš„æ–¹æ³•èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡,<code style="color:#ea4335">this</code>ä¾ç„¶ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡

```js
var a = {
  b: {
    m: function() {
      console.log(this.p);
    },
    p: 'Hello'
  }
};

var hello = a.b.m;
hello() // undefined
```

ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜,å¯ä»¥åªå°†<code style="color:#ea4335">m</code>æ‰€åœ¨å¯¹è±¡èµ‹å€¼ç»™<code style="color:#ea4335">hello</code>,è¿™æ ·è°ƒç”¨æ—¶,<code style="color:#ea4335">this</code>
çš„æŒ‡å‘å°±ä¸ä¼šå˜

```js
var hello = a.b;
hello.m() // Hello
```

## 4.ä½¿ç”¨æ³¨æ„ç‚¹

### 4.1 é¿å…å¤šå±‚this

ç”±äº<code style="color:#ea4335">this</code>çš„æŒ‡å‘æ˜¯ä¸ç¡®å®šçš„,æ‰€ä»¥ä¸èƒ½åœ¨å‡½æ•°ä¸­åŒ…å«å¤šå±‚çš„<code style="color:#ea4335">this</code>

```js
var o = {
  f1: function () {
    console.log(this);
    var f2 = function () {
      console.log(this);
    }();
  }
}
o.f1()
// Object
// Window

//ç­‰åŒäº
var temp = function () {
  console.log(this);
};

var o = {
  f1: function () {
    console.log(this);
    var f2 = temp();
  }
}
```

ä¸€ä¸ªè§£å†³æ–¹æ³•æ˜¯åœ¨ç¬¬äºŒå±‚æ”¹ç”¨ä¸€ä¸ªæŒ‡å‘å¤–å±‚<code style="color:#ea4335">this</code>çš„å˜é‡

```js
var o = {
  f1: function() {
    console.log(this);
    var that = this;
    var f2 = function() {
      console.log(that);
    }();
  }
}

o.f1()
// Object
// Object
```

JavaScriptæä¾›äº†ä¸¥æ ¼æ¨¡å¼,å°±å¯ä»¥ç¡¬æ€§é¿å…è¿™ç§é—®é¢˜.ä¸¥æ ¼æ¨¡å¼ä¸‹,è‹¥å‡½æ•°å†…éƒ¨çš„<code style="color:#ea4335">this</code>æŒ‡å‘é¡¶å±‚å¯¹è±¡,å°±ä¼šæŠ¥é”™

```js
var counter = {
  count: 0
};
counter.inc = function () {
  'use strict';
  this.count++
};
var f = counter.inc;
f()
// TypeError: Cannot read property 'count' of undefined
```

### 4.2 é¿å…æ•°ç»„å¤„ç†æ–¹æ³•ä¸­çš„this

æ•°ç»„çš„<code style="color:#ea4335">Map</code>å’Œ<code style="color:#ea4335">foreach</code>æ–¹æ³•,å…è®¸æä¾›ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°.ä½†è¿™ä¸ªå‡½æ•°å†…éƒ¨ä¸åº”è¯¥ä½¿ç”¨this

è¿™è·Ÿå¤šå±‚<code style="color:#ea4335">this</code>æ˜¯ä¸€æ ·çš„,å°±æ˜¯å†…å±‚çš„<code style="color:#ea4335">this</code>ä¸æŒ‡å‘å¤–éƒ¨,è€ŒæŒ‡å‘é¡¶å±‚å¯¹è±¡

```js
var o = {
  v: 'hello',
  p: [ 'a1', 'a2' ],
  f: function f() {
    var that = this;
    this.p.forEach(function (item) {
      console.log(that.v+' '+item);
    });
  }
}

o.f()
// hello a1
// hello a2
```

### 4.3 é¿å…å›è°ƒå‡½æ•°ä¸­çš„this

```js
var o = new Object();
o.f = function () {
  console.log(this === o);//false
}

// jQuery çš„å†™æ³•
$('#button').on('click', o.f);
```

ä¸Šé¢ä»£ç çš„<code style="color:#ea4335">this</code>ä¸å†æŒ‡å‘<code style="color:#ea4335">o</code>å¯¹è±¡,è€Œæ˜¯æŒ‡å‘æŒ‰é’®çš„DOMå¯¹è±¡,å› ä¸º<code style="color:#ea4335">f</code>æ–¹æ³•æ˜¯åœ¨æŒ‰é’®å¯¹è±¡çš„ç¯å¢ƒä¸­è¢«è°ƒç”¨çš„

## **5.ç»‘å®šthisçš„æ–¹æ³•**

<code style="color:#ea4335">this</code>çš„åŠ¨æ€åˆ‡æ¢ç»™JavaScriptåˆ›é€ äº†å·¨å¤§çš„çµæ´»æ€§ä¹Ÿå¸¦æ¥äº†å›°éš¾å’Œæ¨¡ç³Š

å› æ­¤,JavaScriptæä¾›äº†<code style="color:#ea4335">call</code>ã€<code style="color:#ea4335">apply</code>ã€<code style="color:#ea4335">bind</code>è¿™ä¸‰ä¸ªæ–¹æ³•ï¼Œæ¥åˆ‡æ¢/å›ºå®š<code style="color:#ea4335">this</code>çš„æŒ‡å‘

### 5.1 Function.prototype.call()

å‡½æ•°å®ä¾‹çš„<code style="color:#ea4335">call</code>æ–¹æ³•ï¼Œå¯ä»¥æŒ‡å®šå‡½æ•°å†…éƒ¨<code style="color:#ea4335">this</code>çš„æŒ‡å‘ï¼Œç„¶ååœ¨æŒ‡å®šçš„ä½œç”¨åŸŸä¸­è°ƒç”¨è¯¥å‡½æ•°

```js
var obj = {};

var f = function () {
  return this;
};

f() === window // true
f.call(obj) === obj // true
```

- <code style="color:#ea4335">call</code>æ–¹æ³•çš„å‚æ•°,åº”æ˜¯ä¸€ä¸ªå¯¹è±¡.å¦‚æœå‚æ•°ä¸ºç©º,<code style="color:#ea4335">null</code>å’Œ<code style="color:#ea4335">undefined</code>,åˆ™é»˜è®¤ä¼ å…¥å…¨å±€å¯¹è±¡
- è‹¥<code style="color:#ea4335">call</code>æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼,é‚£ä¹ˆè¿™ä¸ªåŸå§‹å€¼ä¼šè‡ªåŠ¨è½¬æˆå¯¹åº”çš„åŒ…è£…å¯¹è±¡,ç„¶åä¼ å…¥<code style="color:#ea4335">call</code>æ–¹æ³•

```js
var n = 123;
var obj = { n: 456 };

function a() {
  console.log(this.n);
}

a.call() // 123
a.call(null) // 123
a.call(undefined) // 123
a.call(window) // 123
a.call(obj) // 456


var f = function () {
  return this;
};

f.call(5)
// Number {[[PrimitiveValue]]: 5}
```

- <code style="color:#ea4335">call</code>æ–¹æ³•è¿˜å¯ä»¥æ¥å—å¤šä¸ªå‚æ•°
  - ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯<code style="color:#ea4335">this</code>æ‰€è¦æŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡,åé¢çš„å‚æ•°æ˜¯å‡½æ•°è°ƒç”¨æ—¶æ‰€éœ€çš„å‚æ•°

```js
func.call(thisValue, arg1, arg2, ...)
```

<code style="color:#ea4335">call</code>æ–¹æ³•çš„ä¸€ä¸ªåº”ç”¨æ˜¯è°ƒç”¨å¯¹è±¡çš„åŸç”Ÿæ–¹æ³•

```js
var obj = {};
obj.hasOwnProperty('toString') // false

// è¦†ç›–æ‰ç»§æ‰¿çš„ hasOwnProperty æ–¹æ³•
obj.hasOwnProperty = function () {
  return true;
};
obj.hasOwnProperty('toString') // true

Object.prototype.hasOwnProperty.call(obj, 'toString') // false
```

<code style="color:#ea4335">call</code>æ–¹æ³•å°†<code style="color:#ea4335">hasOwnProperty</code>æ–¹æ³•çš„åŸå§‹å®šä¹‰æ”¾åˆ°<code style="color:#ea4335">obj</code>å¯¹è±¡ä¸Šæ‰§è¡Œ,è¿™æ ·æ— è®º<code style="color:#ea4335">obj</code>ä¸Šæœ‰æ²¡æœ‰åŒåæ–¹æ³•éƒ½ä¸ä¼šå½±å“åˆ°ç»“æœ

### 5.2 Function.prototype.apply()

<code style="color:#ea4335">apply</code>çš„ä½œç”¨ä¸<code style="color:#ea4335">call</code>ç±»ä¼¼,ä¹Ÿæ˜¯æ”¹å˜<code style="color:#ea4335">this</code>æŒ‡å‘,ç„¶åå†è°ƒç”¨è¯¥å‡½æ•°,å”¯ä¸€çš„åŒºåˆ«æ˜¯,å®ƒæ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‡½æ•°æ‰§è¡Œæ—¶çš„å‚æ•°

```js
func.apply(thisValue, [arg1, arg2, ...])
```

åŸå‡½æ•°çš„å‚æ•°,åœ¨call()æ–¹æ³•ä¸­å¿…é¡»ä¸€ä¸ªä¸ªæ·»åŠ ,ä½†æ˜¯åœ¨<code style="color:#ea4335">apply</code>æ–¹æ³•ä¸­,å¿…é¡»ä»¥æ•°ç»„å½¢å¼æ·»åŠ 

```js
function f(x, y){
  console.log(x + y);
}

f.call(null, 1, 1) // 2
f.apply(null, [1, 1]) // 2
```

åˆ©ç”¨è¿™ä¸€ç‚¹,å¯ä»¥åšä¸€äº›æœ‰è¶£çš„åº”ç”¨

1. æ‰¾å‡ºæ•°ç»„æœ€å¤§çš„å…ƒç´ 

    JavaScriptä¸æä¾›æ‰¾å‡ºæ•°ç»„æœ€å¤§å…ƒç´ çš„å‡½æ•°,ç»“åˆ<code style="color:#ea4335">apply</code>æ–¹æ³•å’Œ<code style="color:#ea4335">Math.max</code>æ–¹æ³•,å°±å¯ä»¥è¿”å›æ•°ç»„çš„æœ€å¤§å…ƒç´ 

    ```js
    var a = [10, 2, 4, 15, 9];
    Math.max.apply(null, a) // 15
    ```

2. å°†æ•°ç»„çš„ç©ºå…ƒç´ å˜ä¸º<code style="color:#ea4335">undefined</code>

    ç©ºå…ƒç´ ä¸<code style="color:#ea4335">undefined</code>çš„å·®åˆ«åœ¨äº,æ•°ç»„çš„<code style="color:#ea4335">forEach</code>çš„æ–¹æ³•ä¼šè·³è¿‡ç©ºå…ƒç´ ,ä½†æ˜¯ä¸ä¼šè·³è¿‡<code style="color:#ea4335">undefined</code>,å› æ­¤éå†å†…éƒ¨å…ƒç´ çš„æ—¶å€™,ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœ

    ```js
    var a = ['a',, 'b'];

    var b =  Array.apply(null, a);

    a.forEach((value,index,array)=>{
      console.log(value);
    })
    // ['a', 'b']

    b.forEach((value,index,array)=>{
      console.log(value);
    })
    // [ 'a', undefined, 'b' ]
    ```

3. è½¬æ¢ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡

    æ­¤æ–¹æ³•èµ·ä½œç”¨æ˜¯å‰ææ˜¯:è¢«å¤„ç†çš„å¯¹è±¡å¿…é¡»æœ‰<code style="color:#ea4335">length</code>å±æ€§,ä»¥åŠç›¸åº”çš„æ•°å­—é”®

    ```js
    Array.prototype.slice.apply({0: 1, length: 1}) // [1]
    Array.prototype.slice.apply({0: 1}) // []
    Array.prototype.slice.apply({0: 1, length: 2}) // [1, undefined]
    Array.prototype.slice.apply({length: 1}) // [undefined]
    ```

4. ç»‘å®šå›è°ƒå‡½æ•°çš„å¯¹è±¡

å‰é¢çš„æŒ‰é’®ç‚¹å‡»äº‹ä»¶çš„ä¾‹å­,å¯æ”¹å†™å¦‚ä¸‹

```js
var o = new Object();

o.f = function () {
  console.log(this === o);
}

var f = function (){
  o.f.apply(o);
  // æˆ–è€… o.f.call(o);
};

// jQuery çš„å†™æ³•
$('#button').on('click', f);
```

ç”±äº<code style="color:#ea4335">apply</code>æ–¹æ³•/<code style="color:#ea4335">call</code>æ–¹æ³•ä¸ä»…ç»‘å®šå‡½æ•°æ‰§è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡,è¿˜ä¼šç«‹å³æ‰§è¡Œå‡½æ•°,å› æ­¤ä¸å¾—ä¸æŠŠç»‘å®šå‡½æ•°å†™åœ¨ä¸€ä¸ªå‡½æ•°ä½“å†…,æ›´ç›´æ¥å†™æ³•ğŸ‘‡

### 5.3 Function.prototype.bind()

<code style="color:#ea4335">bind()</code>æ–¹æ³•ç”¨äºå°†å‡½æ•°ä½“å†…çš„<code style="color:#ea4335">this</code>ç»‘å®šåˆ°æŸä¸ªå¯¹è±¡,ç„¶åè¿”å›ä¸€ä¸ªæ–°å‡½æ•°

```js
var counter = {
  count: 0,
  inc: function () {
    this.count++;
  }
};

var obj = {
  count: 100
};
var func = counter.inc.bind(obj);
func();
obj.count // 101
```

ä¸Šé¢ä»£ç ä¸­,<code style="color:#ea4335">bind()</code>æ–¹æ³•å°†<code style="color:#ea4335">inc()</code>æ–¹æ³•å†…éƒ¨çš„<code style="color:#ea4335">this</code>,ç»‘å®šåˆ°<code style="color:#ea4335">obj</code>å¯¹è±¡,ç»“æœè°ƒç”¨<code style="color:#ea4335">func</code>å‡½æ•°ä¹‹å,é€’å¢çš„å°±æ˜¯<code style="color:#ea4335">obj</code>å†…éƒ¨çš„<code style="color:#ea4335">count</code>å±æ€§

<code style="color:#ea4335">bind()</code>è¿˜å¯ä»¥æ¥å—æ›´å¤šçš„å‚æ•°,å°†è¿™äº›å‚æ•°ç»‘å®šåŸå‡½æ•°çš„å‚æ•°

```js
var add = function (x, y) {
  return x * this.m + y * this.n;
}

var obj = {
  m: 2,
  n: 2
};

var newAdd = add.bind(obj, 5);
newAdd(5) // 20
```

ä¸Šé¢ä»£ç ä¸­,<code style="color:#ea4335">bind()</code>æ–¹æ³•é™¤äº†ç»‘å®š<code style="color:#ea4335">this</code>å¯¹è±¡,è¿˜å°†<code style="color:#ea4335">add()</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°<code style="color:#ea4335">x</code>ç»‘å®šä¸º<code style="color:#ea4335">5</code>,ç„¶åè¿”å›ä¸€ä¸ªæ–°å‡½æ•°<code style="color:#ea4335">newAdd()</code>,è¿™ä¸ªå‡½æ•°åªéœ€è¦å†æ¥å—ä¸€ä¸ªå‚æ•°<code style="color:#ea4335">y</code>å°±èƒ½è¿è¡Œäº†

å¦‚æœ<code style="color:#ea4335">bind()</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code style="color:#ea4335">null</code>æˆ–<code style="color:#ea4335">undefined</code>,ç­‰äºå°†<code style="color:#ea4335">this</code>ç»‘å®šåˆ°å…¨å±€å¯¹è±¡,å‡½æ•°è¿è¡Œæ—¶<code style="color:#ea4335">this</code>æŒ‡å‘é¡¶å±‚å¯¹è±¡(æµè§ˆå™¨ä¸º<code style="color:#ea4335">window</code>)

```js
function add(x, y) {
  return x + y;
}

var plus5 = add.bind(null, 5);
plus5(10) // 15
```

<code style="color:#ea4335">bind()</code>æ–¹æ³•æœ‰ä¸€äº›ä½¿ç”¨æ³¨æ„ç‚¹

1. æ¯ä¸€æ¬¡è¿”å›ä¸€ä¸ªæ–°å‡½æ•°

    <code style="color:#ea4335">bind()</code>æ–¹æ³•æ¯è¿è¡Œä¸€æ¬¡,å°±è¿”å›ä¸€ä¸ªæ–°å‡½æ•°,è¿™ä¼šäº§ç”Ÿä¸€äº›é—®é¢˜,å¦‚å¯¼è‡´ç›‘å¬äº‹ä»¶ä¸èƒ½å–æ¶ˆç»‘å®š

    ```js
    element.addEventListener('click', o.m.bind(o));
    element.removeEventListener('click', o.m.bind(o));//æ— æ•ˆ
    ```

    æ­£ç¡®å†™æ³•æ˜¯:

    ```js
    var listener = o.m.bind(o);
    element.addEventListener('click', listener);
    //  ...
    element.removeEventListener('click', listener);
    ```

2. ç»“åˆå›è°ƒå‡½æ•°ä½¿ç”¨

    å›è°ƒå‡½æ•°æ˜¯JavaScriptæœ€å¸¸ç”¨çš„æ¨¡å¼ä¹‹ä¸€,ä½†å¸¸è§çš„ä¸€ä¸ªé”™è¯¯:å°†åŒ…å«<code style="color:#ea4335">this</code>çš„æ–¹æ³•ç›´æ¥å½“ä½œå›è°ƒå‡½æ•°,è°ƒç”¨æ—¶æ­¤æ–¹æ³•å†…éƒ¨çš„<code style="color:#ea4335">this</code>å°±ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡

    è§£å†³æ–¹æ³•:

    ä½¿ç”¨<code style="color:#ea4335">bind</code>æ–¹æ³•,å°†<code style="color:#ea4335">counter.inc()</code>ç»‘å®š<code style="color:#ea4335">counter</code>

    ```js
    var counter = {
      count: 0,
      inc: function () {
        'use strict';
        this.count++;
      }
    };

    function callIt(callback) {
      callback();
    }

    callIt(counter.inc.bind(counter));
    counter.count // 1
    ```

    è¿˜æœ‰ä¸€ç§æƒ…å†µ,æŸäº›æ•°ç»„æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°å½“ä½œå‚æ•°,è¿™äº›å‡½æ•°å†…éƒ¨çš„<code style="color:#ea4335">this</code>æŒ‡å‘,å¾ˆå¯èƒ½ä¹Ÿä¼šå‡ºé”™

    ```js
    var obj = {
      name: 'å¼ ä¸‰',
      times: [1, 2, 3],
      print: function () {
        this.times.forEach(function (n) {
          console.log(this.name);
        });
      }
    };

    obj.print()
    // æ²¡æœ‰ä»»ä½•è¾“å‡º
    ```

    è§£å†³è¿™ä¸ªé—®é¢˜,ä¹Ÿæ˜¯é€šè¿‡<code style="color:#ea4335">bind()</code>æ–¹æ³•ç»‘å®š<code style="color:#ea4335">this</code>

    ```js
    obj.print = function () {
      this.times.forEach(function (n) {
        console.log(this.name);
      }.bind(this));
    };

    obj.print()
    // å¼ ä¸‰
    // å¼ ä¸‰
    // å¼ ä¸‰
    ```

3. ç»“åˆ<code style="color:#ea4335">call()</code>æ–¹æ³•ä½¿ç”¨

åˆ©ç”¨<code style="color:#ea4335">bind()</code>æ–¹æ³•,å¯ä»¥æ”¹å†™ä¸€äº›JavaScriptåŸç”Ÿæ–¹æ³•çš„ä½¿ç”¨å½¢å¼,ä»¥æ•°ç»„çš„<code style="color:#ea4335">slice()</code>æ–¹æ³•ä¸ºä¾‹

```js
[1, 2, 3].slice(0, 1) // [1]
// ç­‰åŒäº
Array.prototype.slice.call([1, 2, 3], 0, 1) // [1]
```

ä¸Šè¿°ä»£ç æœ¬è´¨ä¸Šæ˜¯åœ¨<code style="color:#ea4335">[1,2,3]</code>ä¸Šè°ƒç”¨<code style="color:#ea4335">Array.prototype.slice()</code>æ–¹æ³•,å› æ­¤å¯ä»¥ç”¨<code style="color:#ea4335">call</code>æ–¹æ³•è¡¨è¾¾è¿™ä¸ªè¿‡ç¨‹,å¾—åˆ°åŒæ ·çš„ç»“æœ

<code style="color:#ea4335">call()</code>æ–¹æ³•å®é™…ä¸Šæ˜¯è°ƒç”¨<code style="color:#ea4335">Function.prototype.call()</code>æ–¹æ³•,å› æ­¤ä¸Šé¢çš„è¡¨è¾¾å¼å¯ä»¥ç”¨<code style="color:#ea4335">bind()</code>æ–¹æ³•æ”¹å†™

```js
var slice = Function.prototype.call.bind(Array.prototype.slice);
slice([1, 2, 3], 0, 1) // [1]
```

ä¸Šè¿°ä»£ç æ˜¯å°†<code style="color:#ea4335">Array.prototype.slice</code>å˜æˆäº†<code style="color:#ea4335">Function.prototype.call</code>æ–¹æ³•æ‰€åœ¨çš„å¯¹è±¡,è°ƒç”¨æ—¶å°±å˜æˆäº†<code style="color:#ea4335">Array.prototype.slice.call</code>

ç±»ä¼¼å†™æ³•è¿˜å¯ä»¥ç”¨äºå…¶ä»–æ•°ç»„æ–¹æ³•:

```js
var push = Function.prototype.call.bind(Array.prototype.push);
var pop = Function.prototype.call.bind(Array.prototype.pop);

var a = [1 ,2 ,3];
push(a, 4)
a // [1, 2, 3, 4]

pop(a)
a // [1, 2, 3]
```

å¦‚æœå†è¿›ä¸€æ­¥,å°†<code style="color:#ea4335">Function.prototype.call</code>æ–¹æ³•ç»‘å®šåˆ°<code style="color:#ea4335">Function.prototype.bind</code>å¯¹è±¡,å°±æ„å‘³ç€<code style="color:#ea4335">bind</code>çš„è°ƒç”¨å½¢å¼ä¹Ÿå¯ä»¥è¢«æ”¹å†™

```js
function f() {
  console.log(this.v);
}

var o = { v: 123 };
var bind = Function.prototype.call.bind(Function.prototype.bind);
bind(f, o)() // 123
```

ä¸Šè¿°ä»£ç çš„å«ä¹‰æ˜¯å°†<code style="color:#ea4335">Function.prototype.bind</code>æ–¹æ³•ç»‘å®šåœ¨<code style="color:#ea4335">Function.prototype.call</code>ä¸Šé¢,æ•…<code style="color:#ea4335">bind</code>æ–¹æ³•å°±å¯ä»¥ç›´æ¥ä½¿ç”¨
