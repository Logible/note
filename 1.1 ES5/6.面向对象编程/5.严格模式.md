# 严格模式

- [严格模式](#严格模式)
  - [1.The purpose of the design](#1the-purpose-of-the-design)
  - [2.Enabling method](#2enabling-method)
  - [3.Explicit error](#3explicit-error)
    - [3.1 Read-only properties are not writable](#31-read-only-properties-are-not-writable)
    - [3.2 Only properties with setter are not writable](#32-only-properties-with-setter-are-not-writable)
    - [3.3 Objects that are forbidden to expand are not expandable](#33-objects-that-are-forbidden-to-expand-are-not-expandable)
    - [3.4 eval、arguments cannott be used as identifier names](#34-evalarguments-cannott-be-used-as-identifier-names)
    - [3.5 Function cannot have parameters with the same name](#35-function-cannot-have-parameters-with-the-same-name)
    - [3.6 Prohibit octal perfix 0 natation](#36-prohibit-octal-perfix-0-natation)
  - [4.Enhanced security measures](#4enhanced-security-measures)
    - [4.1 Explicit declaration of global variables](#41-explicit-declaration-of-global-variables)
    - [4.2 Prohibit the this keyword from pointing to global object](#42-prohibit-the-this-keyword-from-pointing-to-global-object)

## 1.The purpose of the design

Strict mode reflects the development direction of JavaScript that is more reasonable, safer, and more rigorous.

## 2.Enabling method

The sign to enter strict mode is a one-line string <code style="color:#ea4335">use strict</code>

```js
'use strict';
```

## 3.Explicit error

Strict mode makes JavaScirpt syntax more strict, more operation will explicit report errors.

Some of these operations will fail silently in normal mode, and no error will be report.

### 3.1 Read-only properties are not writable

In strict mode, an error will be reported if the length property is set

```js
'use strict';
'abc'.length = 5;
// TypeError: Cannot assign to read only property 'length' of string 'abc'
```

The above code reports an error because <code style="color:#ea4335">length</code> is a read-only property and cannot be written in strict mode.

In strict mode, an error will be reported if the read-only property is assigned or delelte non-configurable property

```js
// 对只读属性赋值会报错
'use strict';
Object.defineProperty({}, 'a', {
  value: 37,
  writable: false
});
obj.a = 123;
// TypeError: Cannot assign to read only property 'a' of object #<Object>

// 删除不可配置的属性会报错
'use strict';
var obj = Object.defineProperty({}, 'p', {
  value: 1,
  configurable: false
});
delete obj.p
// TypeError: Cannot delete property 'p' of #<Object>
```

### 3.2 Only properties with setter are not writable

In strict mode, an error will be report when assigning a value to a property with only getters and no setters.

```js
'use strict';
var obj = {
  get v() { return 1; }
};
obj.v = 2;
// Uncaught TypeError: Cannot set property v of #<Object> which has only a getter
```

### 3.3 Objects that are forbidden to expand are not expandable

In strict mode, an error will be report if add new propeties to an Object that is forbidden to expand.

```js
'use strict';
var obj = {};
Object.preventExtensions(obj);
obj.v = 1;
// Uncaught TypeError: Cannot add property v, object is not extensible
```

### 3.4 eval、arguments cannott be used as identifier names

In strcit mode, an error will be report if <code style="color:#ea4335">eval</code> or <code style="color:#ea4335">argument</code> is used as identifier name

```js
'use strict';
var eval = 17;
var arguments = 17;
var obj = { set p(arguments) { } };
try { } catch (arguments) { }
function x(eval) { }
function arguments() { }
var y = function eval() { };
var f = new Function('arguments', "'use strict'; return 17;");
// SyntaxError: Unexpected eval or arguments in strict mode
```

### 3.5 Function cannot have parameters with the same name

- In the normal mode, they can be read with <code style="color:#ea4335">argument[i]</code> if the function has multiple parameters with the same name
- In strict mode, this is an error of syntax

```js
function f(a, a, b) {
  'use strict';
  return a + b;
}
// Uncaught SyntaxError: Duplicate parameter name not allowed in this context
```

### 3.6 Prohibit octal perfix 0 natation

- In the normal mode, if the first digit of an integer is 0, it means that it is an octal number
- In strcit mode, an error will be report if the first digit of an integer is 0

```js
'use strict';
var n = 0100;
// Uncaught SyntaxError: Octal literals are not allowed in strict mode.
```

## 4.Enhanced security measures

Strict mode enhances security protection and prevent some accidental errors from the syntax.

### 4.1 Explicit declaration of global variables

- In normal mode, if a variable is assigned without declaration, the default is a global varaible
- Strict mode prohibits this usage, a globle varaible must be declared explicitly.

```js
'use strict';

v = 1; // 报错，v未声明

for (i = 0; i < 2; i++) { // 报错，i 未声明
  // ...
}

function f() {
  x = 123;
}
f() // 报错，未声明就创建一个全局变量
```

Therefore, variables must be declared first, and then used.

### 4.2 Prohibit the this keyword from pointing to global object

- In normal mode, The <code style="color:#ea4335">this</code> of the inside function may be point to global object
- Strict mode prohibits this usage to avoid inadverdently creating global variables.

```js
// 正常模式
function f() {
  console.log(this === window);
}
f() // true

// 严格模式
function f() {
  'use strict';
  console.log(this === undefined);
}
f() // true
```

```js
// 正常模式
function fun() {
  return this;
}

fun() // window
fun.call(2) // Number {2}
fun.call(true) // Boolean {true}
fun.call(null) // window
fun.call(undefined) // window

// 严格模式
'use strict';
function fun() {
  return this;
}

fun() //undefined
fun.call(2) // 2
fun.call(true) // true
fun.call(null) // null
fun.call(undefined) // undefined
```
