# æ–‡ä»¶

- [æ–‡ä»¶](#æ–‡ä»¶)
  - [9.1æ–‡ä»¶å’Œæµçš„æ¦‚å¿µ](#91æ–‡ä»¶å’Œæµçš„æ¦‚å¿µ)
    - [9.1.2æµçš„å®šä¹‰](#912æµçš„å®šä¹‰)
  - [9.2 æ–‡ä»¶çš„ä½¿ç”¨](#92-æ–‡ä»¶çš„ä½¿ç”¨)
    - [9.2.1 æ–‡ä»¶çš„æ‰“å¼€ä¸å…³é—­](#921-æ–‡ä»¶çš„æ‰“å¼€ä¸å…³é—­)
    - [9.2.2 æ–‡ä»¶çš„è¯»å†™æ“ä½œ](#922-æ–‡ä»¶çš„è¯»å†™æ“ä½œ)
      - [1.åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ç»“æŸ](#1åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ç»“æŸ)
      - [2.è¯»å†™å­—ç¬¦å‡½æ•°fgetcå’Œfputcçš„ä½¿ç”¨](#2è¯»å†™å­—ç¬¦å‡½æ•°fgetcå’Œfputcçš„ä½¿ç”¨)
      - [3.è¯»å†™å­—ç¬¦ä¸²å‡½æ•°fgetså’Œfputsçš„ä½¿ç”¨](#3è¯»å†™å­—ç¬¦ä¸²å‡½æ•°fgetså’Œfputsçš„ä½¿ç”¨)
      - [4.æ ¼å¼åŒ–è¾“å…¥ã€è¾“å‡ºå‡½æ•°fscanfå’Œfprintf](#4æ ¼å¼åŒ–è¾“å…¥è¾“å‡ºå‡½æ•°fscanfå’Œfprintf)
      - [5.å—è¯»å†™å‡½æ•°freadå’Œfwriteçš„ä½¿ç”¨](#5å—è¯»å†™å‡½æ•°freadå’Œfwriteçš„ä½¿ç”¨)
    - [9.2.3 æ–‡ä»¶æŒ‡é’ˆçš„å®šä½](#923-æ–‡ä»¶æŒ‡é’ˆçš„å®šä½)
    - [9.2.4 å‡ºé”™çš„æ£€æµ‹](#924-å‡ºé”™çš„æ£€æµ‹)
  - [ä¹ é¢˜](#ä¹ é¢˜)
    - [å¡«ç©ºé¢˜](#å¡«ç©ºé¢˜)
  - [ç¨‹åºå¡«ç©ºé¢˜](#ç¨‹åºå¡«ç©ºé¢˜)

## 9.1æ–‡ä»¶å’Œæµçš„æ¦‚å¿µ

### 9.1.2æµçš„å®šä¹‰

- Cè¯­è¨€æŠŠæ¯ä¸ª**ç‹¬ç«‹çš„æ•°æ®æµ**ç§°ä½œæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½å­˜å‚¨åœ¨ç›¸åº”çš„ç›®å½•(æˆ–è€…æ–‡ä»¶å¤¹)ä¸‹ï¼Œæ–‡ä»¶ç”¨æ–‡ä»¶å(åŒ…æ‹¬æ–‡ä»¶çš„ç›®å½•è·¯å¾„)æ¥æ ‡è¯†

- æ–‡ä»¶ç±»å‹æŒ‡é’ˆ
  - æ‰“å¼€æ–‡ä»¶æ“ä½œå°†è¿”å›ä¸€ä¸ª**æŒ‡å‘FILEçš„æŒ‡é’ˆ**(ç§°ä¸ºæ–‡ä»¶æŒ‡é’ˆ),å®ƒä»£è¡¨æ‰€åˆ›å»ºçš„æµï¼Œå¯¹è¿™ä¸ªæµçš„**æ‰€æœ‰æ“ä½œéƒ½å°†é€šè¿‡è¿™ä¸ªæŒ‡é’ˆè¿›è¡Œ**ã€‚
  - å› æ­¤ä¹Ÿå¯ä»¥è®¤ä¸ºæ–‡ä»¶æŒ‡é’ˆå°±æ˜¯æµçš„ä½“ç°ï¼Œäººä»¬ä¹ŸæŠŠæ–‡ä»¶æŒ‡é’ˆä½œä¸ºæµçš„ä»£åè¯ã€‚

## 9.2 æ–‡ä»¶çš„ä½¿ç”¨

### 9.2.1 æ–‡ä»¶çš„æ‰“å¼€ä¸å…³é—­

```c
FILE* fopen(const char *filename,const char * mode);

FILE *fp;
fp = fopen("myfile_address","r");//æ‰“å¼€ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶åªè¯»
if(fp == NULL){
    /*å½“æ–‡ä»¶æ‰“ä¸å¼€æ—¶çš„å¤„ç†*/
}
/* å¯¹æ–‡ä»¶çš„å„ç§æ“ä½œ */
fclose(fp);
```

- fopenå‚æ•°
  - ![20230401145334](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230401145334.png)

### 9.2.2 æ–‡ä»¶çš„è¯»å†™æ“ä½œ

#### 1.åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ç»“æŸ

```C
int feof(FILE *stream);
```

- å‡½æ•°çš„è¿”å›å€¼è‹¥æ˜¯**é0çš„æ•°**ï¼Œåˆ™è¯´æ˜æ–‡ä»¶æŒ‡é’ˆå·²æŒ‡å‘æ–‡ä»¶çš„ç»“å°¾äº†

```C
while(!feof(fp))
  putch(fgetc(fp));
```

#### 2.è¯»å†™å­—ç¬¦å‡½æ•°fgetcå’Œfputcçš„ä½¿ç”¨

- fgetcå‡½æ•°ä»è¾“å…¥æµçš„å½“å‰ä½ç½®**è¿”å›ä¸€ä¸ªå­—ç¬¦**ï¼Œå¹¶å°†æ–‡ä»¶æŒ‡é’ˆ**æŒ‡ç¤ºå™¨ç§»åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦å¤„**ï¼Œå¦‚æœå·²åˆ°æ–‡ä»¶å°¾ï¼Œå‡½æ•°è¿”å›EOF

  ```c
  int fgetc(FILE *stream);
  /*ä»æ–‡ä»¶è¯»ä¸€å­—ç¬¦*/
  ch = fgetc(fp);
  ```

  ```c
  if((fp = fopen(argv[0],"r"))==NULL) {
    printf("not open");
    return 0;
  }

  while(!feof(fp)) {
    ch = fgetc(fp);
    putchar(ch);
  }
  ```

- fputcå‡½æ•°å®Œæˆå°†å­—ç¬¦chçš„å€¼**å†™å…¥æ‰€æŒ‡å®šçš„æµæ–‡ä»¶çš„å½“å‰ä½ç½®å¤„**ï¼Œå¹¶å°†æ–‡ä»¶æŒ‡é’ˆåç§»ä¸€ä½ã€‚fputcå‡½æ•°çš„**è¿”å›å€¼æ˜¯æ‰€å†™å…¥å­—ç¬¦çš„å€¼**ï¼Œå‡ºé”™æ—¶è¿”å›EOFã€‚

  ```c
  int fputc(int ch,FILE *stream);
  //*å°†ä¸€ä¸ªå­—ç¬¦å†™å…¥æ–‡ä»¶*/
  fputc(ch,fp);
  ```

  ```c
  FILE*fp;
  char ch;
  if((fp = fopen("D:\\test.txt","w"))==NULL) {
    printf("cannot open file!\n");
    exit(0);
  }

  while((ch=getchar())!='\n')
    fputc(ch,fp); /*å°†ä¸€ä¸ªå­—ç¬¦å†™å…¥æ–‡ä»¶*/
  fclose(fp);
  return 0;

  D:\>type test.txt
  12345
  ```

#### 3.è¯»å†™å­—ç¬¦ä¸²å‡½æ•°fgetså’Œfputsçš„ä½¿ç”¨

- fgetså‡½æ•°ä»æµæ–‡ä»¶streamä¸­è¯»å–è‡³å¤šnum-1ä¸ªå­—ç¬¦ï¼Œå¹¶æŠŠå®ƒä»¬æ”¾å…¥stræŒ‡å‘çš„å­—ç¬¦æ•°ç»„ä¸­ã€‚
  - è¯»å–å­—ç¬¦ç›´åˆ°é‡è§æŒ‰Enteré”®ç¬¦
  - æˆ–EOF(æ–‡ä»¶ç»“æŸç¬¦)ä¸ºæ­¢
  - æˆ–è¯»å…¥äº†æ‰€é™å®šçš„å­—ç¬¦æ•°ã€‚

```c
char *fgets(char *str,int num,FILE *stream);

//ä»æ–‡ä»¶ä¸­è¯»å›çš„å­—ç¬¦ä¸²é•¿åº¦å¤§äº0
while(fgets(str,128,fp1)>0){
  fputs(str,fp2);//ä»æ–‡ä»¶1è¯»å­—ç¬¦ä¸²å¹¶å†™å…¥æ–‡ä»¶2
}
```

- fputså‡½æ•°å°†**stræŒ‡å‘çš„å­—ç¬¦ä¸²å†™å…¥æµæ–‡ä»¶**
  - æ“ä½œæˆåŠŸæ—¶ï¼Œå‡½æ•°è¿”å›0å€¼
  - å¤±è´¥è¿”å›éé›¶å€¼ã€‚

```c
int fputs(char *str,FILE *stream):

FILE *fp1
char str[128];
//...æ‰“å¼€æ–‡ä»¶
while(scanf("%s",str) != EOF){ //è¾“å…¥Ctrl+Zåˆ™ç»“æŸ
  fputs(str,fp); //å†™å…¥ä¸²
  fputs("\n",fp); //å†™å…¥æŒ‰Enteré”®
}
```

#### 4.æ ¼å¼åŒ–è¾“å…¥ã€è¾“å‡ºå‡½æ•°fscanfå’Œfprintf

- å¯¹æ–‡ä»¶çš„æ ¼å¼åŒ–è¯»å†™å°±æ˜¯åœ¨ä¸Šè¿°å‡½æ•°çš„å‰é¢åŠ ä¸€ä¸ªå­—æ¯fæˆä¸ºfscanf()å’Œfprintf()ã€‚å…¶å‡½æ•°è°ƒç”¨æ–¹å¼ï¼š

```c
int fscanf(FILE *stream,char * format,arg_list);
int fprintf(FILE *stream,char * format,arg_list);
```

![20230320203859](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320203859.png)

#### 5.å—è¯»å†™å‡½æ•°freadå’Œfwriteçš„ä½¿ç”¨

- Cè¯­è¨€æä¾›æˆå—çš„è¯»å†™æ–¹å¼æ¥æ“ä½œæ–‡ä»¶ï¼Œä½¿å…¶æ•°ç»„æˆ–ç»“æ„ä½“ç­‰ç±»å‹å¯ä»¥è¿›è¡Œä¸€æ¬¡æ€§è¯»å†™ã€‚å…¶å‡½æ•°çš„åŸå‹åˆ†åˆ«æ˜¯ï¼š

```c
size_t fread(void *pointer,size_t size,size_t num,FILE*stream);
size_t fwrite(void *pointer,size_t size,size_t num,FILE *stream);
```

- fread**ä»streamè¯»**
  - å®ƒè¦æ±‚è¯»å…¥
    - æ¯ä¸ªå…ƒç´ çš„å¤§å°ä¸ºsize
    - numä¸ªæ•°æ®å…ƒç´ 
    - æŒ‡é’ˆå‚æ•°pointeråº”æŒ‡å‘æ¥æ”¶æ•°æ®çš„èµ·å§‹å­˜å‚¨ä½ç½®
- fwrite**å†™å…¥stream**
  - å‡½æ•°fwrite**å‘æµstreamè¾“å‡ºä¸€æ‰¹æ•°æ®**
  - æ•°æ®çš„èµ·å§‹ä½ç½®ç”±æŒ‡é’ˆpointerç»™å®š
  - å…ƒç´ å¤§å°æ˜¯size,å…±numä¸ª
  - è¿™äº›æ•°æ®å…ƒç´ å°†é¡ºåºå­˜å…¥ä¸æµstreamç›¸å…³è”çš„æ–‡ä»¶é‡Œã€‚

### 9.2.3 æ–‡ä»¶æŒ‡é’ˆçš„å®šä½

![20230320210617](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320210617.png)

### 9.2.4 å‡ºé”™çš„æ£€æµ‹

- åœ¨è°ƒç”¨å„ç§è¾“å…¥ã€è¾“å‡ºå‡½æ•°(å¦‚fputcã€fgetcã€freadã€fwriteç­‰)æ—¶ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œé™¤äº†å‡½æ•°è¿”å›å€¼æœ‰æ‰€åæ˜ å¤–ï¼Œè¿˜å¯ä»¥ç”¨ferrorå‡½æ•°æ£€æŸ¥ã€‚å…¶å‡½æ•°çš„åŸå‹ä¸ºï¼š

```c
int ferror(FILE* stream);

clearerr(stream); /*é‡ç½®é”™è¯¯æ ‡è®°å¹¶å°†æ–‡ä»¶æŒ‡é’ˆç½®ä½EOF*/
```

- å¦‚æœferror**è¿”å›å€¼ä¸º0(å‡)**,è¡¨ç¤ºæ–‡ä»¶æ“ä½œæœªå‡ºé”™ï¼›
- å¦‚æœè¿”å›ä¸€ä¸ªé0å€¼ï¼Œåˆ™è¯´æ˜æ–‡ä»¶æ“ä½œå¤±è´¥

- åº”å½“æ³¨æ„çš„æ˜¯ï¼Œå¯¹åŒä¸€ä¸ªæ–‡ä»¶**æ¯ä¸€æ¬¡è°ƒç”¨**è¾“å…¥ã€è¾“å‡ºå‡½æ•°ï¼Œ**å‡äº§ç”Ÿä¸€ä¸ªæ–°çš„ferrorå‡½æ•°å€¼**ï¼Œå› æ­¤ï¼Œåº”å½“åœ¨è°ƒç”¨ä¸€ä¸ªè¾“å…¥ã€è¾“å‡ºå‡½æ•°åç«‹å³æ£€æŸ¥ferrorå‡½æ•°çš„å€¼ï¼Œå¦åˆ™ä¿¡æ¯ä¼šä¸¢å¤±

## ä¹ é¢˜

â­

- 04![20230320212959](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320212959.png)
- 09![20230320213235](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320213235.png)
  - ğŸ’šwå¯ç”¨äºåˆ›å»ºæ–°æ–‡ä»¶

â­

- 01![20230320212733](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320212733.png)
  - ğŸ’šé”®ç›˜æ˜¾ç¤ºå™¨
- 02![20230320212803](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320212803.png)
  - ğŸ’šåŒåæ–œçº¿
- 03![20230320212836](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320212836.png)
  - ğŸ’šNULLåœ¨Cå°±æ˜¯0
- 05![20230320213041](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320213041.png)
- 08![20230320213139](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320213139.png)

### å¡«ç©ºé¢˜

â­â­

- 07![20230320213818](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320213818.png)
  - ğŸ’šå­—èŠ‚, æµå¼
- 01![20230320213259](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320213259.png)
  - ğŸ’šæµæ–‡ä»¶ä¸¤ç§å½¢å¼
- 05![20230320213700](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320213700.png)
  - æ–‡æœ¬,äºŒè¿›åˆ¶

â­

- 06![20230320213744](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320213744.png)
  - 01

## ç¨‹åºå¡«ç©ºé¢˜

â­

- 01 ä»¥ä¸‹ç¨‹åºçš„åŠŸèƒ½æ˜¯å°†æ–‡ä»¶file1.cçš„å†…å®¹è¾“å‡ºåˆ°å±å¹•ä¸Šå¹¶å¤åˆ¶åˆ°æ–‡ä»¶file2.cä¸­<image style="height:400px; background-color:#CDDEC2" src="https://raw.githubusercontent.com/Logible/Image/main/note_image/20230320214248.png"/>
- 02ä»¥ä¸‹ç¨‹åºçš„åŠŸèƒ½æ˜¯å°†æ–‡ä»¶stud_dataä¸­ç¬¬iä¸ªå­¦ç”Ÿçš„å§“åã€å­¦å·ã€å¹´é¾„ã€æ€§åˆ«è¾“å‡º
  - <image style="height:300px; background-color:#CDDEC2" src="https://raw.githubusercontent.com/Logible/Image/main/note_image/20230321100229.png"/>
- 04ä»¥ä¸‹ç¨‹åºä»ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­è¯»å…¥ç»“æ„ä½“æ•°æ®ï¼Œå¹¶æŠŠç»“æ„ä½“æ•°æ®æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œ![20230321101356](https://raw.githubusercontent.com/Logible/Image/main/note_image/20230321101356.png)
  - ğŸ’šreadçš„å‚æ•°
