# 文件

- [文件](#文件)
  - [9.1文件和流的概念](#91文件和流的概念)
    - [9.1.2流的定义](#912流的定义)
  - [9.2 文件的使用](#92-文件的使用)
    - [9.2.1 文件的打开与关闭](#921-文件的打开与关闭)
    - [9.2.2 文件的读写操作](#922-文件的读写操作)
      - [1.判断文件是否结束](#1判断文件是否结束)
      - [2.读写字符函数fgetc和fputc的使用](#2读写字符函数fgetc和fputc的使用)

## 9.1文件和流的概念

### 9.1.2流的定义

- C语言把每个**独立的数据流**称作文件，每个文件都存储在相应的目录(或者文件夹)下，文件用文件名(包括文件的目录路径)来标识

- 文件类型指针
  - 打开文件操作将返回一个**指向FILE的指针**(称为文件指针),它代表所创建的流，对这个流的**所有操作都将通过这个指针进行**。
  - 因此也可以认为文件指针就是流的体现，人们也把文件指针作为流的代名词。

## 9.2 文件的使用

### 9.2.1 文件的打开与关闭

```c
FILE *fp;
fp = fopen("myfile_address","r");//打开一个文本文件只读
if(fp == NULL){
    /*当文件打不开时的处理*/
}
/* 对文件的各种操作 */
fclose(fp);
```

### 9.2.2 文件的读写操作

#### 1.判断文件是否结束

```C
int feof(FILE *stream);
```

- 函数的返回值若是非0的数，则说明文件指针已指向文件的结尾了

```C
while(!feof(fp))
  putch(fgetc(fp));
```

#### 2.读写字符函数fgetc和fputc的使用

- fgetc函数从输入流的当前位置**返回一个字符**，并将文件指针指示器移到下一个字符处，如果已到文件尾，函数返回EOF

  ```c
  int fgetc(FILE *stream);
  /*从文件读一字符*/
  ch = fgetc(fp);
  ```

  ```c
  if((fp = fopen(argv[0],"r"))==NULL) {
    printf("not open");
    return 0;
  }

  while(!feof(fp)) {
    ch = fgetc(fp);
    putchar(ch);
  }
  ```

- fputc函数完成将字符ch的值**写入所指定的流文件的当前位置处**，并将文件指针后移一位。fputc函数的**返回值是所写入字符的值**，出错时返回EOF。

  ```c
  int fputc(int ch,FILE *stream);
  //*将一个字符写入文件*/
  fputc(ch,fp);
  ```

  ```c
  FILE*fp;
  char ch;
  if((fp = fopen("D:\\test.txt","w"))==NULL) {
    printf("cannot open file!\n");
    exit(0);
  }

  while((ch=getchar())!='\n')
    fputc(ch,fp); /*将一个字符写入文件*/
  fclose(fp);
  return 0;

  D:\>type test.txt
  12345
  ```
